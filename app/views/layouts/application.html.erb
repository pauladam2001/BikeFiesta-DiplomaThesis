<!DOCTYPE html>
<html>
  <head>
    <title>BikeFiesta</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <% if current_user.present? && current_user.is_normal? %>
        <div class="menu">
          <div class="">
            <h6><%= link_to image_tag("logo.png", border: 0, width: '200px'), posts_path %></h6>
          </div>
          <div class="menu-item first-item <%= 'current-menu-item' if @current == 1 %>">
              <h6><%= link_to "Home", posts_path %></h6>
              <div class="<%= 'wee' if @current == 1 %>"></div>
          </div>
          <div class="menu-item <%= 'current-menu-item' if @current == 2 %>">
              <h6>Short</h6>
              <div class="<%= 'wee' if @current == 2 %>"></div>
          </div>
          <div class="menu-item <%= 'current-menu-item' if @current == 3 %>">
              <h6>Longer Navigation</h6>
              <div class="<%= 'wee' if @current == 3 %>"></div>
          </div>
          <div class="menu-item <%= 'current-menu-item' if @current == 4 %>">
              <h6>Random</h6>
              <div class="<%= 'wee' if @current == 4 %>"></div>
          </div>
          <div class="menu-item <%= 'current-menu-item' if !@current.present? %>">
              <% if current_user.provider == "google_oauth2" %>
                <h6><%= link_to image_tag(current_user.avatar_url, border: 0, width: '40px', class: "image-radius"), edit_user_registration_path %></h6>
              <% else %>
                <% if current_user.avatar.attached? %>
                  <h6><%= link_to image_tag(current_user.avatar, border: 0, width: '80px', class: "image-radius"), edit_user_registration_path %></h6>
                <% else %>
                  <h6><%= link_to image_tag("user-icon.png", border: 0, width: '40px'), edit_user_registration_path %></h6>
                <% end %>
              <% end %>
              <div class="<%= 'wee' if !@current.present? %>"></div>
          </div>
          <div class="menu-item">
              <h6><%= link_to image_tag("logout-icon.png", border: 0, width: '35px'), destroy_user_session_path, data: {turbo: "false"}, method: :delete %></h6>
          </div>
        </div>
    <% elsif current_user.present? && current_user.is_admin? %>
        TODO
    <% end %>
    <%= yield %>
  </body>
</html>

<script type="text/javascript">
  $(document).ready(function() {
    $(window).on('load resize', function() {
      var $thisnav = $('.current-menu-item').offset().left;

      $('.menu-item').hover(function() {
        var $left = $(this).offset().left - $thisnav;
        var $width = $(this).outerWidth();
        var $start = 0;
        $('.wee').css({ 'left': $left , 'width': $width });
      }, function() {
        var $initwidth = $('.current-menu-item').width();
        $('.wee').css({ 'left': '0' , 'width': $initwidth });
      });
    });

  });
</script>
